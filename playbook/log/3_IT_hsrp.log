
PLAY [障害試験 & 結果確認Playbook] *********************************************

TASK [[事前確認] Ubuntuから現在の経路を確認] ***********************************
changed: [L2SW_MNO -> localhost]

TASK [[DEBUG] 事前経路の表示] **************************************************
ok: [L2SW_MNO] => {
    "msg": [
        "ターゲットIP: 192.168.20.8",
        "期待する0系GW: 192.168.1.2",
        "実際のtraceroute結果:",
        [
            "traceroute to 192.168.20.8 (192.168.20.8), 30 hops max, 60 byte packets",
            " 1  192.168.10.252  1.159 ms",
            " 2  192.168.1.2  2.754 ms",
            " 3  192.168.2.1  5.061 ms",
            " 4  192.168.3.2  5.053 ms",
            " 5  192.168.3.1  5.045 ms",
            " 6  192.168.20.8  5.012 ms"
        ]
    ]
}

TASK [[判定] FW0系を通っているか検証] ******************************************
ok: [L2SW_MNO] => {
    "changed": false,
    "msg": "0系経由の通信を確認しました。"
}

TASK [[障害発生] Ethernet0/1 をシャットダウン] *********************************
changed: [L2SW_MNO]

TASK [[監視] 疎通復旧を待機中 (Ping実行中...)] *********************************
changed: [L2SW_MNO -> localhost]

TASK [[DEBUG] 復旧までの試行回数] **********************************************
ok: [L2SW_MNO] => {
    "msg": "Pingが成功しました。試行回数: 1回 (約1秒)"
}

TASK [[事後確認] 復旧後の経路を確認] *******************************************
changed: [L2SW_MNO -> localhost]

TASK [[DEBUG] 事後経路の表示] **************************************************
ok: [L2SW_MNO] => {
    "msg": [
        "迂回後のtraceroute結果:",
        [
            "traceroute to 192.168.20.8 (192.168.20.8), 30 hops max, 60 byte packets",
            " 1  192.168.10.253  0.708 ms",
            " 2  192.168.1.2  4.297 ms",
            " 3  192.168.2.1  4.429 ms",
            " 4  192.168.3.2  5.187 ms",
            " 5  *",
            " 6  192.168.20.8  5.311 ms"
        ]
    ]
}

TASK [[判定] 1系を通っているか検証] ********************************************
ok: [L2SW_MNO] => {
    "changed": false,
    "msg": "1系への正常な切り替えを確認しました。"
}

TASK [[切り戻し] Ethernet0/1 を no shutdown] ***********************************
changed: [L2SW_MNO]

TASK [[最終確認] インターフェース状態] *****************************************
ok: [L2SW_MNO]

TASK [[DEBUG] 最終ステータス表示] **********************************************
ok: [L2SW_MNO] => {
    "msg": "インターフェース Ethernet0/1 は UP です。"
}

PLAY RECAP *********************************************************************
L2SW_MNO                   : ok=12   changed=5    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   

